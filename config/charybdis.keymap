#include <dt-bindings/zmk/mouse.h>
#include <input/processors.dtsi>
#include <zephyr/dt-bindings/input/input-event-codes.h>
#include <behaviors.dtsi>
#include <dt-bindings/zmk/keys.h>
#include <dt-bindings/zmk/pointing.h>

#define ZMK_POINTING_DEFAULT_MOVE_VAL 1000 // 600
#define ZMK_POINTING_DEFAULT_SCRL_VAL 12   // 10

&lt {
    tapping-term-ms = <200>;
    flavor = "balanced";
    quick-tap-ms = <150>;
};

&mmv_input_listener { input-processors = <&zip_xy_scaler 2 1>; };

&msc_input_listener { input-processors = <&zip_scroll_scaler 2 1>; };

&msc {
    acceleration-exponent = <0>;      // 0
    time-to-max-speed-ms = <100>;       // 300
    delay-ms = <0>;                   // 0
};

&mmv {
    time-to-max-speed-ms = <300>;
    acceleration-exponent = <1>;
    trigger-period-ms = <16>;
};

/ {
    // 上下滚动编码器行为

    scroll_vertical_encoder: scroll_vertical_encoder {
        compatible = "zmk,behavior-sensor-rotate";
        #sensor-binding-cells = <0>;
        bindings = <&msc SCRL_DOWN>, <&msc SCRL_UP>;

        tap-ms = <100>;
    };

    // 左右滚动编码器行为

    scroll_horizontal_encoder: scroll_horizontal_encoder {
        compatible = "zmk,behavior-sensor-rotate";
        #sensor-binding-cells = <0>;
        bindings = <&msc SCRL_LEFT>, <&msc SCRL_RIGHT>;

        tap-ms = <100>;
    };

    behaviors {
    };

    combos { compatible = "zmk,combos"; };

    keymap {
        compatible = "zmk,keymap";

        layer_0 {
            bindings = <
&kp ESCAPE        &kp N1  &kp N2  &kp N3        &kp N4         &kp N5            &kp N6            &kp N7             &kp N8              &kp N9          &kp N0         &kp MINUS
&kp TAB           &kp Q   &kp W   &kp E         &kp R          &kp T             &kp Y             &kp U              &kp I               &kp O           &kp P          &kp EQUAL
&kp LEFT_SHIFT    &kp A   &kp S   &kp D         &kp F          &kp G             &kp H             &mt RIGHT_SHIFT J  &mt LEFT_CONTROL K  &mt LEFT_ALT L  &kp SEMICOLON  &kp SQT
&kp LEFT_CONTROL  &kp Z   &kp X   &kp C         &kp V          &kp B             &kp N             &kp M              &kp COMMA           &kp PERIOD      &kp FSLH       &kp MINUS
                                  &kp LEFT_ALT  &kp BACKSPACE  &lt 1 LEFT_WIN    &kp LEFT_CONTROL  &kp SPACE
                                                &mkp LCLK      &mkp RCLK         &kp ENTER
            >;

            sensor-bindings =
                <&scroll_vertical_encoder>,
                // 编码器1：上下滚动,,,,,,,,,,,,,,,,,,,,
                <&scroll_horizontal_encoder>;

            // 编码器2：左右滚动
        };

        layer_1 {
            bindings = <
&kp F1          &kp F2  &kp F3          &kp F4             &kp F5           &kp F6                  &kp F7                 &kp F8        &kp F9        &kp F10       &kp F11  &kp F12
&kp CAPS        &none   &trans          &kp UP_ARROW       &none            &kp LEFT_BRACE          &kp RIGHT_BRACE        &kp NUMBER_7  &kp NUMBER_8  &kp NUMBER_9  &trans   &tog 2
&kp LEFT_SHIFT  &trans  &kp LEFT_ARROW  &kp DOWN_ARROW     &kp RIGHT_ARROW  &kp LEFT_BRACKET        &kp RIGHT_BRACKET      &kp NUMBER_4  &kp NUMBER_5  &kp NUMBER_6  &trans   &tog 3
&kp LCTRL       &none   &kp K_PREV      &kp K_PLAY_PAUSE   &kp C_NEXT       &kp LEFT_PARENTHESIS    &kp RIGHT_PARENTHESIS  &kp NUMBER_1  &kp NUMBER_2  &kp NUMBER_3  &none    &trans
                                        &kp C_VOLUME_DOWN  &kp C_VOLUME_UP  &kp C_PLAY_PAUSE        &kp RIGHT_ALT          &mkp RCLK
                                                           &trans           &trans                  &mkp LCLK
            >;
        };

        rainbow_six {
            bindings = <
&kp ESCAPE    &kp NUMBER_1      &kp NUMBER_2  &kp NUMBER_3  &kp NUMBER_4      &kp N5          &trans    &trans     &trans     &trans  &trans     &trans
&kp U         &kp TAB           &kp Q         &kp W         &kp E             &kp R           &trans    &trans     &trans     &trans  &trans     &trans
&kp NUMBER_6  &kp LEFT_SHIFT    &kp A         &kp S         &kp D             &kp F           &trans    &trans     &trans     &trans  &trans     &trans
&kp NUMBER_7  &kp LEFT_CONTROL  &kp Z         &kp X         &kp C             &kp V           &trans    &mkp LCLK  &mkp RCLK  &trans  &mkp MCLK  &trans
                                              &kp B         &kp G             &kp SPACE       &tog 2    &mkp MB5
                                                            &kp C_PLAY_PAUSE  &kp LEFT_ALT    &mkp MB4
            >;
        };

        layer_3 {
            bindings = <
&kp ESCAPE  &kp NUMBER_1      &kp NUMBER_2  &kp NUMBER_3  &kp NUMBER_4      &kp N5          &trans    &trans     &trans     &trans  &trans     &trans
&kp U       &kp TAB           &kp Q         &kp W         &kp E             &kp R           &trans    &trans     &trans     &trans  &trans     &trans
&kp M       &kp LEFT_SHIFT    &kp A         &kp S         &kp D             &kp F           &trans    &trans     &trans     &trans  &trans     &trans
&kp H       &kp LEFT_CONTROL  &kp Z         &kp X         &kp C             &kp V           &trans    &mkp LCLK  &mkp RCLK  &trans  &mkp MCLK  &trans
                                            &kp B         &kp G             &kp SPACE       &tog 3    &mkp MB5
                                                          &kp C_PLAY_PAUSE  &kp LEFT_ALT    &mkp MB4
            >;
        };

        /* layer_2 {
            bindings = <
&none  &none   &none    &none   &none         &none         &kp N1         &none         &none     &none  &none   &to 0
&none  &none   &none    &none   &none         &none         &none         &none          &rgb_ug RGB_BRD &rgb_ug RGB_BRI  &rgb_ug RGB_EFF   &rgb_ug RGB_TOG
&none  &none   &none    &none   &none         &none         &none         &mkp LCLK     &mkp RCLK  &none  &none   &none
&none  &none   &none    &none   &bt BT_NXT  &bt BT_CLR    &none         &none         &none     &none  &none   &none
                                   &none         &none         &none         &none         &none
                                                 &none         &none         &none
            >;
       
            
        };

       Mouse {
            bindings = <
&none        &none         &none         &none         &none      &none         &none       &none      &none         &none         &none         &none
&none        &bt BT_SEL 0  &bt BT_SEL 1  &bt BT_SEL 3  &none      &bt BT_CLR    &bt BT_CLR  &none      &bt BT_SEL 2  &bt BT_SEL 1  &bt BT_SEL 0  &none
&none        &trans        &trans        &mkp MCLK     &trans     &none         &none       &trans     &mkp MCLK     &trans        &trans        &none
&bootloader  &trans        &mkp RCLK     &mo 4         &mkp LCLK  &mo 5         &mo 5       &mkp LCLK  &mo 4         &mkp RCLK     &trans        &bootloader
                                         &mo 5         &mkp LCLK  &mkp RCLK     &mkp RCLK   &mkp LCLK
                                                       &none      &trans        &trans
            >;

            
        };

        layer_4 {
            bindings = <
&trans  &trans  &trans     &trans     &trans     &trans       &trans     &trans     &trans     &trans     &trans  &trans
&trans  &trans  &trans     &trans     &trans     &trans       &trans     &trans     &trans     &trans     &trans  &trans
&trans  &trans  &trans     &mkp MCLK  &trans     &trans       &trans     &trans     &mkp MCLK  &trans     &trans  &trans
&trans  &trans  &mkp RCLK  &trans     &mkp LCLK  &trans       &trans     &mkp LCLK  &trans     &mkp RCLK  &trans  &trans
                           &trans     &mkp LCLK  &mkp RCLK    &mkp RCLK  &mkp LCLK
                                      &trans     &trans       &trans
            >;
                
                
               
        };

        layer_5 {
            bindings = <
&trans  &trans  &trans     &trans     &trans     &trans       &trans     &trans     &trans     &trans     &trans  &trans
&trans  &trans  &trans     &trans     &trans     &trans       &trans     &trans     &trans     &trans     &trans  &trans
&trans  &trans  &trans     &mkp MCLK  &trans     &trans       &trans     &trans     &mkp MCLK  &trans     &trans  &trans
&trans  &trans  &mkp RCLK  &trans     &mkp LCLK  &trans       &trans     &mkp LCLK  &trans     &mkp RCLK  &trans  &trans
                           &trans     &mkp LCLK  &mkp RCLK    &mkp RCLK  &mkp LCLK
                                      &trans     &trans       &trans
            >;
                
                
        };*/
    };
};
